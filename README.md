<!-- todo arch explanation -->

# Сценарий тестирования kafka
- Создать юзера через /auth/sign/up
- Авторизоваться через созданного юзера через /auth/validate
- Найти созданного юзера в поиске /user/search
- Объект с данными юзера отредактировать и отправить PUT запрос на /user
- Проверить изменения через поиск


# Отчет о производительности находится в ./benchmark/perfomance.md

# Содержимое проекта
- ./benchmark - скрипты для тестирования производительности и отчет о производительности
- ./docs - документация по проекту. Тут находится OpenApi.
- ./config - конфигурация бд
- ./database - менеджер подключений к бд, описание сущностей бд
- ./auth_service - реализация сервиса авторизации
- ./user_service - реалиазция сервиса пользователей
- ./product_service - реализация сервиса работы с продаваемыми услугами
- ./utils - набор утилит для упрощения работы
- ./docker/mariadb - контейнер бд со скриптом создания таблиц (./rollout/). Скрипт вызывается автоматически при первом запуске контейнера.
- ./docker/proxysql - контейнер для proxysql
- ./docker/.env - переменные окружения для запуска контейнеров
- ./docker/docker-compose.yaml - конфигурация запуска контейнеров
- auth_main.cpp, user_main.cpp и product_main.cpp - точки входа контейнеров сервисов авторизации, пользователей и продаваемы услуг соотвественно

# Запуск:
```
docker compose build
docker compose up
```

# Алгоритм проверки
- [опционально] Создать пользователя через /auth/sign/up или же использовать уже созданного тестового пользователя (autotest1/123 или autotest2/123)
- Авторизоваться через /auth/sign/in (basic auth) с помощью логина/пароля: autotest1/123 или autotest2/123
- Полученный токен используются при обращении к остальным сервисам (кроме /auth/sign/up)
- Далее можно можно обращаться к любым сервисам, например
    - Поискать других юзеров через /user/search
    - Отредактировать юзера через [PUT] /user
    - Создать новый лот продукта через [POST] /product
    - Найти созданный лот через /product/search
    - Отредактировать свой лот через [PUT] /product/edit
    - Удалить свой лот [DELETE] /product
    - Удалить юзера [DELETE] /user

<b>!!!ВНИМАНИЕ!!!</b>

Новый пользователь не будет иметь прав админа и сможет удалять только свои записи.
Созданные для тестов юзеры (autotest_admin, autotest_user0, autotest_user1, autotest_user2, autotest_user3) имеют права админов и могут удалять любые сущности.

# Api
Конфигурация ендпоинтов описана в ./docs/index.yaml.

Для авторизации можно использовать тестовых пользователей:
- autotest_admin / 123
- autotest_user0 / 123
- autotest_user1 / 123
- autotest_user2 / 123
- autotest_user3 / 123

Или же создать своего.